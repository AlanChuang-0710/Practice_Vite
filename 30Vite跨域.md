# [補充篇] vite 處理跨域

同源策略僅發生在**瀏覽器**

跨域: 當 A 源 向 B 源 (不滿足同源策略，就會觸發同源限制) 請求對應信息，就會產生跨域，
跨域請求默認情況下，會被瀏覽器攔截，除非對應請求的服務器出具標記說 A 源 是被允許拿 B 源的東西。

**跨域限制是服務器已經有響應東西，但是瀏覽器不給你，並不是服務器沒有響應東西**

## 實現

1.  如果沒有寫域名，瀏覽器會先幫我們做一步拼接
    故上述請求會先變成http://127.0.0.1:5173/api

2.  接著將該請求傳給 vite，vite 發現該請求的 path 有配置跨域代理策略，
    根據 vite.config.js 中的 proxy 配置重新求取請求。
    將 api 替換為""，並改請求https://www.google.com/

## 原理

1. 在本地自己開一個服務器，先請求自己的服務器
2. 自己的服務器再去請求 google 的服務器 (服務器對服務器沒有同源策略)
3. 自己的服務器獲得響應後，再將響應結果發送給瀏覽器

## 應用

- 開發時: 我們一般就利用 構建工具、腳手架或者第三方庫的 proxy 代理配置，或著我們自己搭一個開發服務器來解決問題。

- 生產時: 一般交由後端處理跨域:
  1. nginx: 代理服務 (本質原理與 vite 跨域配置一樣)
  2. 配置身分標記
     Access-Control-Allow-Origin: 標記允許訪問的網域
     例如: 向 https://miao.baidu.com/abdr發送請求，回傳的響應頭中帶有 Access-Control-Allow-Origin: https://baike.baidu.com，允許baike.baidu.com獲得miao.baidu.com的響應。
